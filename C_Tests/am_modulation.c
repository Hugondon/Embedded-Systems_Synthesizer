#include <stdio.h>
#include <stdint.h>
#include <math.h>

#define NS 100
#define PI 3.14159

void modulate_wave(uint8_t lfo_freq_hz);


uint16_t modulated_sine [NS] = {0};
uint16_t sine_LUT [] = {
		2048, 2177, 2307, 2435, 2562, 2686, 2808, 2928, 3043, 3154, 3261, 3364, 3460, 3552, 3637,
		3715, 3787, 3852, 3910, 3960, 4003, 4037, 4064, 4082, 4093, 4095, 4089, 4074, 4052, 4021,
		3982, 3936, 3882, 3821, 3752, 3677, 3595, 3507, 3413, 3313, 3209, 3099, 2986, 2868, 2748,
		2624, 2499, 2371, 2242, 2112, 1983, 1853, 1724, 1596, 1471, 1347, 1227, 1109, 996, 886,
		782, 682, 588, 500, 418, 343, 274, 213, 159, 113, 74, 43, 21, 6, 0,
		2, 13, 31, 58, 92, 135, 185, 243, 308, 380, 458, 543, 635, 731, 834,
		941, 1052, 1167, 1287, 1409, 1533, 1660, 1788, 1918, 2047
};

uint16_t sawtooth_LUT [] = {
		0, 41, 83, 124, 165, 207, 248, 290, 331, 372, 414, 455, 496, 538, 579,
		620, 662, 703, 745, 786, 827, 869, 910, 951, 993, 1034, 1075, 1117, 1158, 1200,
		1241, 1282, 1324, 1365, 1406, 1448, 1489, 1530, 1572, 1613, 1655, 1696, 1737, 1779, 1820,
		1861, 1903, 1944, 1985, 2027, 2068, 2110, 2151, 2192, 2234, 2275, 2316, 2358, 2399, 2440,
		2482, 2523, 2565, 2606, 2647, 2689, 2730, 2771, 2813, 2854, 2895, 2937, 2978, 3020, 3061,
		3102, 3144, 3185, 3226, 3268, 3309, 3350, 3392, 3433, 3475, 3516, 3557, 3599, 3640, 3681,
		3723, 3764, 3805, 3847, 3888, 3930, 3971, 4012, 4054, 0
};

uint16_t triangle_LUT [] = {
		0, 83, 165, 248, 331, 414, 496, 579, 662, 745, 827, 910, 993, 1075, 1158,
		1241, 1324, 1406, 1489, 1572, 1655, 1737, 1820, 1903, 1985, 2068, 2151, 2234, 2316, 2399,
		2482, 2565, 2647, 2730, 2813, 2895, 2978, 3061, 3144, 3226, 3309, 3392, 3475, 3557, 3640,
		3723, 3805, 3888, 3971, 4054, 4054, 3971, 3888, 3805, 3723, 3640, 3557, 3475, 3392, 3309,
		3226, 3144, 3061, 2978, 2895, 2813, 2730, 2647, 2565, 2482, 2399, 2316, 2234, 2151, 2068,
		1985, 1903, 1820, 1737, 1655, 1572, 1489, 1406, 1324, 1241, 1158, 1075, 993, 910, 827,
		745, 662, 579, 496, 414, 331, 248, 165, 83, 0
};

uint16_t square_LUT [] = {
		4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
		4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
		4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
		4095, 4095, 4095, 4095, 4095, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0
};

uint32_t i = 0;

int main(void){
    modulate_wave(1);
}

void modulate_wave(uint8_t lfo_freq_hz){
    printf("ORIGINAL\n");
    for(i = 0; i < NS; i++) printf("%d, ", sine_LUT[i]);
    printf("\n");
    printf("\n");
    printf("LFO\n");
    for(i = 0; i < NS; i++) printf("%lf, ", 1 + sin(2*PI*i*lfo_freq_hz/NS));
    printf("\n");
    for(i = 0; i< NS; i++) modulated_sine[i] = sine_LUT[i]*( 0.5*sin(2*PI*i*10/NS) + 0.5);
    printf("\n");
	printf("[");
    for(i = 0; i < NS; i++) printf("%d ", modulated_sine[i]);
	printf("]");

}

